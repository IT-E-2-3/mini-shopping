<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team3.shopping.dao.OrderDao">
	<select id="getMyCartByMlogin" resultType="cart"
		parameterType="String">
		SELECT mid, pid, color_code, size_code, camount
		FROM
		mycart
		where mid = #{mid}
	</select>

	<select id="getPriceByCartPid" resultType="cart"
		parameterType="cart">
		SELECT price
		FROM product
		where mid = #{cart.pid}
	</select>

	<select id="getMidBymolgin" parameterType="String"
		resultType="String">
		SELECT mid FROM member where mlogin_id =#{mlogin_id}
	</select>

	<select id="selectAllbyMid" parameterType="String"
		resultType="order">
		SELECT OID ,MID ,ODATE, OZIP_CODE,
		OADDRESS, ODETAIL_ADDRESS
		,ORECIPIENT, ORECIPIENT_TEL ,OTOTAL_PRICE
		,OCHANNEL, OCARD_NAME,
		OCARD_INSTALLMENTRATE
		,OCARD_INSTALLMENT_PERIOD, OACCOUNTHOLDER,
		ODEPOSIT_DEADLINE
		FROM ORDERS
		where MID=#{mid}
	</select>

	<select id="selectOrderbyOid" parameterType="String"
		resultType="order">
		SELECT OID ,MID ,ODATE, OZIP_CODE,
		OADDRESS, ODETAIL_ADDRESS
		,ORECIPIENT, ORECIPIENT_TEL ,OTOTAL_PRICE
		,OCHANNEL, OCARD_NAME,
		OCARD_INSTALLMENTRATE
		,OCARD_INSTALLMENT_PERIOD, OACCOUNTHOLDER,
		ODEPOSIT_DEADLINE
		FROM ORDERS
		where OID=#{oid}
	</select>

	<select id="selectOrderItemsbyOid" parameterType="String"
		resultType="orderItem">
		SELECT OID, PID, COLOR_CODE, SIZE_CODE, OAMOUNT
		FROM
		ORDER_ITEMS
		where OID=#{oid}
	</select>

	<select id="selectPnamebyPid" parameterType="String"
		resultType="String">
		SELECT PNAME
		FROM PRODUCT
		WHERE PID=#{pid}
	</select>

	<select id="selectImageUrl" resultType="String">
		SELECT
		product_detail_url1
		FROM color_url
		WHERE PID=#{pid} AND
		COLOR_CODE=#{pcolor}
	</select>

	<select id="selectProductbyOid" parameterType="String" resultType="orderRowDetail">
		select order_items.oid, color_url.color_code, product_detail_url1, pbrand, pname, pprice, order_items.oamount, order_items.size_code
		from color_url join product on color_url.pid = product.pid join order_items on color_url.pid = order_items.pid and color_url.color_code = order_items.color_code
		where exists (
		select * from order_items 
		where oid = #{oid} and color_url.pid = order_items.pid and color_url.color_code = order_items.color_code)
	</select>

</mapper>